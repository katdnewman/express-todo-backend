(this["webpackJsonpreact-todo-app"]=this["webpackJsonpreact-todo-app"]||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),r=a(22),s=a.n(r),o=a(6),i=(a(75),a(10)),d=a(12),j=a(104),l=a(2),u=a(54);function b(e,t){switch(console.log(e),t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function O(e,t){switch(t.type){case"CREATE_TODO":return[{_id:t._id,title:t.title,description:t.description,dateCreated:t.dateCreated,author:t.author,complete:!1,completedOn:void 0}].concat(Object(u.a)(e));case"TOGGLE_TODO":return e.map((function(e){return console.log("toggle reducer "+t),e._id===t.id?Object(l.a)(Object(l.a)({},e),{},{completedOn:t.completedOn,complete:t.complete}):e}));case"DELETE_TODO":return console.log("Delete: "+t.id),e.filter((function(e){return e._id!==t.id}));case"FETCH_TODOS":return t.todos;default:return e}}function h(e,t){return console.log(t),{user:b(e.user,t),todos:O(e.todos,t)}}var p=a(8),x=a(9),m=a(1);function f(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)(""),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(c.useContext)(p.a),l=j.state,u=j.dispatch,b=l.user,O=Object(x.b)((function(e){var t=e.title,a=e.description,c=e.author,n=e.dateCreated;return{url:"/todo",method:"post",headers:{Authorization:"".concat(l.user.access_token)},data:{title:t,description:a,author:c,dateCreated:n}}})),h=Object(o.a)(O,2),f=h[0],g=h[1];return Object(c.useEffect)((function(){f&&f.data&&(console.log(f.data),u({type:"CREATE_TODO",title:f.data.title,content:f.data.description,id:f.data.id,author:b.username}),console.log(f.data))}),[f]),Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(){var e=(new Date).toString();g({title:a,description:i,author:b.username,dateCreated:e})}()},children:[Object(m.jsx)("div",{children:Object(m.jsx)("b",{children:"Create To do"})}),Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(m.jsx)("input",{type:"text",value:a,onChange:function(e){n(e.target.value)},name:"create-title",id:"create-title"})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{htmlFor:"create-desc",children:"Description:"}),Object(m.jsx)("input",{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"create-desc",id:"create-desc"})]}),Object(m.jsx)("input",{type:"submit",value:"Create"}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{})]})}function g(e){var t=e.title,a=e.description,n=e.dateCreated,r=e.complete,s=e.completedOn,i=e.id,d=Object(c.useContext)(p.a),j=d.state,l=d.dispatch,u=Object(x.b)((function(e){return{url:"/todo/"+e.id,headers:{Authorization:"".concat(j.user.access_token)},method:"delete"}})),b=Object(o.a)(u,2),O=b[0],h=b[1],f=Object(x.b)((function(e){var t=e.id,a=e.newDateCompleted;return{url:"/todo/"+t,method:"put",headers:{Authorization:"".concat(j.user.access_token)},data:{id:t,complete:!r,completedOn:a}}})),g=Object(o.a)(f,2),v=g[0],C=g[1];return Object(c.useEffect)((function(){O&&O.data&&l({type:"DELETE_TODO",id:i})}),[O]),Object(c.useEffect)((function(){v&&v.data&&(console.log("togTodo "+v.data.completedOn),l({type:"TOGGLE_TODO",id:i,completedOn:v.data.completedOn,complete:v.data.complete}))}),[v]),Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{children:["Title: ",t]}),Object(m.jsxs)("div",{children:["Description: ",a]}),Object(m.jsxs)("div",{children:["Date created: ",n," "]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{htmlFor:"completed-todo",children:"Completed: "}),Object(m.jsx)("input",{type:"checkbox",checked:r,onChange:function(e){console.log("handleCompleteBox");var t="";r||(t=(new Date).toString()),C({id:i,newDateCompleted:t})},id:"completed-todo",name:"completed-todo"})]}),Object(m.jsxs)("div",{children:["Date Completed: ",s]}),Object(m.jsx)("button",{onClick:function(e){console.log("Delete "+i),h({id:i})},children:"Delete"}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{})]})}function v(e){var t=e.id,a=Object(c.useContext)(p.a).state,n=Object(x.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(a.user.access_token)},method:"get"}})),r=Object(o.a)(n,2),s=r[0],i=r[1];return Object(c.useEffect)(i,[t]),Object(m.jsxs)("div",{children:[s&&s.data?Object(m.jsx)(g,{dateCreated:s.data.dateCreated,complete:s.data.complete,completedOn:s.data.completedOn,title:s.data.title,description:s.data.description,id:s.data._id}):"Loading...",Object(m.jsx)("div",{children:Object(m.jsx)(d.a,{href:"/",children:"Go back"})})]})}var C=a(108),w=a(106),y=a(103);function E(e){var t=e.show,a=e.handleClose,n=Object(c.useContext)(p.a).dispatch,r=Object(c.useState)({username:"",password:"",passwordRepeat:""}),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(c.useState)(""),u=Object(o.a)(j,2),b=(u[0],u[1]),O=Object(x.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),h=Object(o.a)(O,2),f=h[0],g=h[1];return Object(c.useEffect)((function(){f&&f.data&&n({type:"REGISTER",username:f.data.username})}),[f]),Object(c.useEffect)((function(){f&&!1===f.isLoading&&(f.data||f.error)&&(f.error?(console.log(f),b("Registration failed, please try again later."),alert("fail")):(console.log(f),b("Registration successful. You may now login."),alert("success")))}),[f]),Object(m.jsx)(C.a,{show:t,onHide:a,children:Object(m.jsxs)(w.a,{onSubmit:function(e){e.preventDefault(),g(i.username,i.password),a()},children:[Object(m.jsx)(C.a.Header,{closeButton:!0,children:Object(m.jsx)(C.a.Title,{children:"Register"})}),Object(m.jsxs)(C.a.Body,{children:[Object(m.jsx)(w.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(m.jsx)(w.a.Control,{type:"text",value:i.username,onChange:function(e){return d(Object(l.a)(Object(l.a)({},i),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(m.jsx)(w.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(m.jsx)(w.a.Control,{type:"password",name:"register-password",id:"register-password",value:i.password,onChange:function(e){return d(Object(l.a)(Object(l.a)({},i),{},{password:e.target.value}))}}),Object(m.jsx)(w.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(m.jsx)(w.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:i.passwordRepeat,onChange:function(e){return d(Object(l.a)(Object(l.a)({},i),{},{passwordRepeat:e.target.value}))}})]}),Object(m.jsxs)(C.a.Footer,{children:[Object(m.jsx)(y.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(m.jsx)(y.a,{variant:"primary",type:"submit",disabled:0===i.username.length||0===i.password.length||i.password!==i.passwordRepeat,children:"Register"})]})]})})}function L(e){var t=e.show,a=e.handleClose,n=Object(c.useContext)(p.a).dispatch,r=Object(c.useState)(""),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(c.useState)(""),l=Object(o.a)(j,2),u=l[0],b=l[1],O=Object(c.useState)(!1),h=Object(o.a)(O,2),f=h[0],g=h[1];var v=Object(x.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),E=Object(o.a)(v,2),L=E[0],k=E[1];return Object(c.useEffect)((function(){L&&!1===L.isLoading&&(L.data||L.error)&&(L.error?(g(!0),alert("failed")):(g(!1),console.log(L.data),n({type:"LOGIN",username:i,access_token:L.data.access_token})))}),[L]),Object(m.jsx)(C.a,{show:t,onHide:a,children:Object(m.jsxs)(w.a,{onSubmit:function(e){e.preventDefault(),k(i,u),a()},children:[Object(m.jsx)(C.a.Header,{closeButton:!0,children:Object(m.jsx)(C.a.Title,{children:"Login"})}),Object(m.jsxs)(C.a.Body,{children:[Object(m.jsx)(w.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(m.jsx)(w.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(m.jsx)(w.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(m.jsx)(w.a.Control,{type:"password",value:u,onChange:function(e){b(e.target.value)},name:"login-password",id:"login-password"}),f&&Object(m.jsx)(w.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(m.jsxs)(C.a.Footer,{children:[Object(m.jsx)(y.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(m.jsx)(y.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})}function k(){var e=n.a.lazy((function(){return a.e(3).then(a.bind(null,109))})),t=Object(c.useContext)(p.a).state,r=Object(c.useState)(!1),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(c.useState)(!1),l=Object(o.a)(j,2),u=l[0],b=l[1];return t.user.username?Object(m.jsx)(e,{}):Object(m.jsxs)("div",{className:"justify-content-end",children:[Object(m.jsx)(y.a,{variant:"link",onClick:function(e){return d(!0)},children:"Login"}),Object(m.jsx)(L,{show:i,handleClose:function(){return d(!1)}}),Object(m.jsx)(y.a,{variant:"link",onClick:function(e){return b(!0)},children:"Register"}),Object(m.jsx)(E,{show:u,handleClose:function(){return b(!1)}})]})}var T=a(107),D=function(e){var t=e.text;return Object(m.jsx)(d.a,{href:"/",children:Object(m.jsx)(T.a.Brand,{children:t})})},_=a(105);function S(){var e=Object(c.useContext)(p.a).state.user;return console.log("Headerbar "+e.username),Object(m.jsx)(T.a,{bg:"light",expand:"lg",children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)(T.a.Brand,{href:"/",children:Object(m.jsx)(D,{text:"My Blog"})}),Object(m.jsx)(T.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(m.jsxs)(T.a.Collapse,{id:"basic-navbar-nav",children:[Object(m.jsx)(_.a,{className:"me-auto",children:Object(m.jsx)(_.a.Link,{children:Object(m.jsx)(d.a,{href:"/users",children:"Users"})})}),Object(m.jsx)(_.a,{className:"me-auto",children:e.username&&Object(m.jsx)(_.a.Link,{children:Object(m.jsx)(d.a,{href:"/todo/create",children:"Create New Post"})})}),Object(m.jsx)(n.a.Suspense,{fallback:"Loading...",children:Object(m.jsx)(k,{})})]})]})})}function R(){var e=Object(c.useContext)(p.a).state.todos;return Object(m.jsx)("div",{children:e.map((function(e,t){return Object(m.jsx)(g,{dateCreated:e.dateCreated,complete:e.complete,completedOn:e.completedOn,title:e.title,description:e.description,id:e._id},"todo-"+t)}))})}function F(){var e=Object(c.useContext)(p.a),t=e.state,a=e.dispatch,n=Object(x.b)((function(){return{url:"/todo",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),r=Object(o.a)(n,2),s=r[0],i=r[1];Object(c.useEffect)((function(){i()}),[t.user.access_token]),Object(c.useEffect)((function(){s&&!1===s.isLoading&&s.data&&(console.log("todos data "+s.data),a({type:"FETCH_TODOS",todos:s.data.todos}))}),[s]);s.data;var d=s.isLoading;return Object(m.jsxs)(m.Fragment,{children:[d&&"todos loading..."," ",Object(m.jsx)(R,{})]})}function G(){Object(c.useContext)(p.a).state;var e=Object(x.b)((function(){return{url:"user",method:"get"}})),t=Object(o.a)(e,2),a=t[0],n=t[1];return Object(c.useEffect)(n,[]),a&&!a.isLoading&&a.data&&console.log(a.data.userlist[0].username),Object(m.jsxs)("div",{children:[Object(m.jsx)("h3",{children:Object(m.jsx)("b",{children:"Users"})}),a&&!a.isLoading&&a.data?a.data.userlist.map((function(e,t){return Object(m.jsxs)(d.a,{href:"/users/"+e.userid,children:[e.username," ",Object(m.jsx)("br",{})]})})):"Loading",Object(m.jsx)("div",{children:Object(m.jsxs)(d.a,{href:"/",children:[Object(m.jsx)("br",{}),"Go back"]})})]})}function B(e){var t=e.title,a=e.description,c=e.dateCreated,n=e.completedOn;return Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{children:["Title: ",t]}),Object(m.jsxs)("div",{children:["Description: ",a]}),Object(m.jsxs)("div",{children:["Date created: ",c," "]}),Object(m.jsxs)("div",{children:["Date Completed: ",n]}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{})]})}function A(e){var t=e.userid,a=(Object(c.useContext)(p.a).state,Object(x.b)((function(){return{url:"user/"+t,method:"get"}}))),n=Object(o.a)(a,2),r=n[0],s=n[1];return Object(c.useEffect)(s,[]),r&&!r.isLoading&&r.data&&console.log(r.data.todos),Object(m.jsxs)("div",{children:[Object(m.jsx)("h3",{children:Object(m.jsx)("b",{children:"Profile"})}),r&&!r.isLoading&&r.data?r.data.todos.map((function(e,t){return Object(m.jsx)(B,{dateCreated:e.dateCreated,completedOn:e.completedOn,title:e.title,description:e.description},"todo-"+t)})):"Loading",Object(m.jsx)("div",{children:Object(m.jsx)(d.a,{href:"/users",children:"Go back"})})]})}var H=function(){var e=Object(c.useReducer)(h,{user:{},todos:[]}),t=Object(o.a)(e,2),a=t[0],n=t[1],r=(a.user,Object(i.f)({"/":Object(i.g)({view:Object(m.jsx)(F,{})}),"/users":Object(i.g)({view:Object(m.jsx)(G,{})}),"/users/:userid":Object(i.g)((function(e){return{view:Object(m.jsx)(A,{userid:e.params.userid})}})),"/todo/create":Object(i.g)({view:Object(m.jsx)(f,{})}),"/todo/:id":Object(i.g)((function(e){return{view:Object(m.jsx)(v,{id:e.params.id})}}))}));return Object(m.jsx)("div",{children:Object(m.jsx)(p.a.Provider,{value:{state:a,dispatch:n},children:Object(m.jsx)(d.b,{routes:r,children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)(S,{}),Object(m.jsx)("hr",{}),Object(m.jsx)(d.c,{})]})})})})},z=a(36),I=a.n(z).a.create({baseURL:"/"});s.a.render(Object(m.jsx)(n.a.StrictMode,{children:Object(m.jsx)(x.a,{value:I,children:Object(m.jsx)(H,{})})}),document.getElementById("root"))},8:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var c=a(0),n=a.n(c).a.createContext({state:{},dispatch:function(){}})}},[[100,1,2]]]);
//# sourceMappingURL=main.d757403f.chunk.js.map